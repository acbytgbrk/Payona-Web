<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Payona</title>
    <link rel="stylesheet" href="~/css/main.css" />
</head>
<body>
    <div class="app-container">
        <nav class="navbar" id="navbar">
            <div class="navbar-content">
                <a href="/" class="navbar-brand">üçΩÔ∏è Payona</a>
                <div class="navbar-links" id="navbarLinks">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </nav>

        <main class="main-content">
            @RenderBody()
        </main>

        <footer style="text-align: center; padding: 2rem; color: var(--text-secondary);">
            <p>&copy; 2025 Payona - √ñƒürenci Yemek Payla≈üƒ±m Platformu</p>
        </footer>
    </div>

    <script type="module">
        import { authService } from '/js/modules/auth.js';
        import { themeService } from '/js/modules/theme.js';

        // Initialize theme
        themeService.init();
        themeService.updateToggleButton();

        // Setup navigation
        const navbarLinks = document.getElementById('navbarLinks');
        const user = authService.getCurrentUser();
        const isAuthenticated = authService.isAuthenticated();

        if (isAuthenticated && user) {
            navbarLinks.innerHTML = `
                <a href="/Dashboard" class="nav-link">Ana Sayfa</a>
                <a href="/Profile" class="nav-link">Profil</a>
                <button class="theme-toggle btn btn-secondary" id="themeToggle" style="padding: 0.5rem;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6" style="width: 1.25rem; height: 1.25rem;">
                        <path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 01.162.819A8.97 8.97 0 009 6a9 9 0 009 9 8.97 8.97 0 003.463-.69.75.75 0 01.981.98 10 10 0 01-9.694 6.46c-5.799 0-10.5-4.701-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 01.818.162z" clip-rule="evenodd"/>
                    </svg>
                </button>
                <button class="btn btn-secondary" id="logoutBtn">√áƒ±kƒ±≈ü Yap</button>
            `;
            
            // Add logout event listener
            document.getElementById('logoutBtn')?.addEventListener('click', async () => {
                await authService.logout();
            });
        } else {
            navbarLinks.innerHTML = `
                <a href="/" class="nav-link">Giri≈ü</a>
                <button class="theme-toggle btn btn-secondary" id="themeToggle" style="padding: 0.5rem;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6" style="width: 1.25rem; height: 1.25rem;">
                        <path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 01.162.819A8.97 8.97 0 009 6a9 9 0 009 9 8.97 8.97 0 003.463-.69.75.75 0 01.981.98 10 10 0 01-9.694 6.46c-5.799 0-10.5-4.701-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 01.818.162z" clip-rule="evenodd"/>
                    </svg>
                </button>
            `;
        }

        // Theme toggle handler
        document.getElementById('themeToggle')?.addEventListener('click', () => {
            themeService.toggle();
        });
    </script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>

